<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Create Package | TrailVenture</title>
    <link rel="stylesheet" href="create.css">
</head>
<body>

<div class="dashboard">
    <aside class="sidebar">
        <h2 class="logo">TrailVenture</h2>
        <nav class="menu">
            <a href="dashboardguide.html"> My Profile</a>
            <a href="create.html" style="background:rgba(255,255,255,0.2)">Create Package</a>
            <a href="package.html">View Packages</a>
            <a href="index.html">Logout</a>
        </nav>
    </aside>

    <main class="content">
        <header class="page-header">
            <h1>Create Hiking Package</h1>
            <p>Fill in details. Only items with (*) will be published.</p>
        </header>

        <section class="card">
            <form id="packageForm">
                <div class="form-group">
                    <label>Package Category*</label>
                    <select id="pCategory" required>
                        <option value="">Select category</option>
                        <option>Hiking</option>
                        <option>Camping</option>
                        <option>Beginner Trip</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Package Name *</label>
                    <input type="text" id="pName" placeholder="Mt. Kinabalu Summit" required>
                </div>

                <div class="form-group">
                    <label>Location *</label>
                    <input type="text" id="pLocation" placeholder="Sabah" required>
                </div>

                <div class="form-group">
                    <label>Duration *</label>
                    <input type="text" id="pDuration" placeholder="3 Days 2 Nights" required>
                </div>

                <div class="form-row" style="display:flex; gap:20px;">
                    <div class="form-group" style="flex:1;">
                        <label>Price (RM) *</label>
                        <input type="number" id="pPrice" required>
                    </div>
                    <div class="form-group" style="flex:1;">
                        <label>Contact *</label>
                        <input type="tel" id="pContact" placeholder="014-213-4636" required>
                    </div>
                </div>

                <div class="form-group">
                    <label>Attach Package Image *</label>
                    <input type="file" id="pImageFile" accept="image/*" required onchange="previewImage()">
                    <div id="preview-container">
                        <small>Preview:</small><br>
                        <img id="preview-img" src="" alt="Preview">
                    </div>
                </div>

                <div class="internal-notes">
                    <label>Internal Notes (Private)</label>
                    <small>This part will NOT be published to the view area.</small>
                    <textarea placeholder="Secret notes..."></textarea>
                </div>

                <div class="form-actions" style="margin-top:20px;">
                    <button type="reset" class="btn secondary">Reset</button>
                    <button type="submit" class="btn primary" id="submitBtn">Publish Package</button>
                </div>
            </form>
        </section>
    </main>
</div>

<script>
    function previewImage() {
        const file = document.getElementById('pImageFile').files[0];
        const preview = document.getElementById('preview-img');
        const container = document.getElementById('preview-container');
        
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
                container.style.display = 'block';
            }
            reader.readAsDataURL(file);
        }
    }

    document.getElementById('packageForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const fileInput = document.getElementById('pImageFile');
        const file = fileInput.files[0];

        if (file) {
            const reader = new FileReader();
            
            reader.onload = function(event) {
                const imageData = event.target.result;

                const newPackage = {
                    category: document.getElementById('pCategory').value,
                    name: document.getElementById('pName').value,
                    location: document.getElementById('pLocation').value,
                    duration: document.getElementById('pDuration').value,
                    price: document.getElementById('pPrice').value,
                    contact: document.getElementById('pContact').value,
                    image: imageData, 
                    guide: "Verified Guide", 
                    id: Date.now() 
                };

                let packages = JSON.parse(localStorage.getItem('myPackages')) || [];
                packages.push(newPackage);
                localStorage.setItem('myPackages', JSON.stringify(packages));

                alert("Success! Package with image published.");
                window.location.href = "package.html";
            };

            reader.readAsDataURL(file);
        }
    });
</script>
</body>
</html>